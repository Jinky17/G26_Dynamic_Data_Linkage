{"cells":[{"cell_type":"markdown","source":["## This Notebook is created for Testing 100 records datasets with different OCPs (0 - 20 - 40)"],"metadata":{"id":"6ZgZZEwFeWUl"}},{"cell_type":"markdown","metadata":{"id":"Ne-0NhduiJwf"},"source":["## Import all the required packages/libraries "]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5820,"status":"ok","timestamp":1667463793481,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"},"user_tz":-660},"id":"w-qKaZP_4zqC","outputId":"de000759-acb4-496b-9385-7976222579cb"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting bitarray\n","  Downloading bitarray-2.6.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (235 kB)\n","\u001b[K     |████████████████████████████████| 235 kB 4.1 MB/s \n","\u001b[?25hInstalling collected packages: bitarray\n","Successfully installed bitarray-2.6.0\n","29 30 0.95 0.9201101928374655\n","jesse dobson 0.0 0.275\n","female female 1.0 1.0\n","99 1 0.85 0.8092105263157895\n","99 1 0.0 0.5740181268882175\n"]}],"source":["#reusing the Bloom filter codes\n","!pip install bitarray\n","import BF_encoding\n","import pandas as pd\n","import time \n","\n","from sklearn.cluster import AgglomerativeClustering\n","from scipy.cluster.hierarchy import dendrogram, linkage\n","from statistics import mean\n","from bitarray import bitarray\n","from sklearn.metrics import silhouette_score\n","from matplotlib import pyplot as plt"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"ZtRgJVtMK4NY","executionInfo":{"status":"ok","timestamp":1667463793481,"user_tz":-660,"elapsed":10,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["#initialisng bloom filter object\n","bf_len = 50 #Bloom filter length\n","bf_num_hash_func = 2 #Number of hash functions\n","bf_num_inter = 5 #Number of intervals to use for BF based similarities\n","bf_step = 1 # \n","max_abs_diff = 40 #Maximum absolute difference allowed\n","min_val = 0 #Minimum value\n","max_val = 100 #Maximum value\n","q = 2 #Length of sub-strings/q-grams"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"2WSz22GfK9UW","executionInfo":{"status":"ok","timestamp":1667463793482,"user_tz":-660,"elapsed":10,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["bf = BF_encoding.BF(bf_len, bf_num_hash_func, bf_num_inter, bf_step,\n","          max_abs_diff, min_val, max_val, q)"]},{"cell_type":"markdown","metadata":{"id":"3JOtQId9iGvk"},"source":["------------------------------------------------------------------------------------------------------"]},{"cell_type":"markdown","metadata":{"id":"ret0mJmDyM0l"},"source":["# Loading the first 3 raw 100 records datasets \n"]},{"cell_type":"markdown","source":["### Loading Datasets with 0 OCP"],"metadata":{"id":"R8JShDRj5J4f"}},{"cell_type":"code","execution_count":258,"metadata":{"id":"hMOy__xM6F-x","executionInfo":{"status":"ok","timestamp":1667452435406,"user_tz":-660,"elapsed":7,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["rec_db1 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_0_myp_0_nump_5.csv',True, None)\n","rec_db2 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_0_myp_1_nump_5.csv',True, None)\n","rec_db3 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_0_myp_2_nump_5.csv',True, None)\n","rec_db4 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_0_myp_3_nump_5.csv',True, None)\n","rec_db5 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_0_myp_4_nump_5.csv',True, None)"]},{"cell_type":"markdown","source":["### Loading Datasets with 20 OCP"],"metadata":{"id":"tfsuqZgT5vQ6"}},{"cell_type":"code","source":["rec_db1_20 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_20_myp_0_nump_5.csv',True, None)\n","rec_db2_20 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_20_myp_1_nump_5.csv',True, None)\n","rec_db3_20 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_20_myp_2_nump_5.csv',True, None)\n","rec_db4_20 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_20_myp_3_nump_5.csv',True, None)\n","rec_db5_20 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_20_myp_4_nump_5.csv',True, None)"],"metadata":{"id":"RzH7faUo5QV0","executionInfo":{"status":"ok","timestamp":1667452293489,"user_tz":-660,"elapsed":11,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"execution_count":236,"outputs":[]},{"cell_type":"markdown","source":["### Loading Datasets with 40 OCP"],"metadata":{"id":"DHWEDuFk5wMt"}},{"cell_type":"code","source":["rec_db1_40 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_40_myp_0_nump_5.csv',True, None)\n","rec_db2_40 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_40_myp_1_nump_5.csv',True, None)\n","rec_db3_40 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_40_myp_2_nump_5.csv',True, None)\n","rec_db4_40 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_40_myp_3_nump_5.csv',True, None)\n","rec_db5_40 = bf.__read_csv_file__('ncvr_numrec_100_modrec_2_ocp_40_myp_4_nump_5.csv',True, None)"],"metadata":{"id":"jwHk48Pq5RgN","executionInfo":{"status":"ok","timestamp":1667463796121,"user_tz":-660,"elapsed":5,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":165},"executionInfo":{"elapsed":6,"status":"error","timestamp":1667463796589,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"},"user_tz":-660},"id":"HgCQOPLpxLrJ","outputId":"4f3ad885-62f7-4d93-f9de-3702eb493725"},"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-5-a971909b9561>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrec_db1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;31m#check data type of the 1st datasets > it is a dict\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'rec_db1' is not defined"]}],"source":["print(type(rec_db1)) #check data type of the 1st datasets > it is a dict"]},{"cell_type":"markdown","metadata":{"id":"hNT9Ml8MiA0O"},"source":["------------------------------------------------------------------------------------------------------"]},{"cell_type":"markdown","metadata":{"id":"nFXp1hr6yVJr"},"source":["# Create bloom filter of the first 5 datasets\n","### -- using pandas as pd\n","### -- create a dictionary that has the combined BF from the 3 datasets - 0 OCP"]},{"cell_type":"code","execution_count":259,"metadata":{"id":"onM4BRlY4-SE","executionInfo":{"status":"ok","timestamp":1667452438446,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["listBF = list() # creating a list to store hashed arrays of first 3 table only\n","dictBF = dict()"]},{"cell_type":"code","execution_count":260,"metadata":{"id":"mVhJeGSPnk6f","executionInfo":{"status":"ok","timestamp":1667452438856,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["# for each record of selected csv file, use BF encoding, combine all the columns into a single array and hash it, and store \n","temp1 = dict()\n","db1 = list()\n","for k, v in rec_db1.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4] \n","  val2_set = [store]\n","  bf1 = bf.set_to_bloom_filter(val2_set)\n","  temp1[v[0]] = bf1 # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf1)\n","  db1.append(1)"]},{"cell_type":"code","execution_count":261,"metadata":{"id":"n0gjNMS6w0Fr","executionInfo":{"status":"ok","timestamp":1667452439262,"user_tz":-660,"elapsed":408,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["temp2 = dict()\n","db2 = list()\n","for k, v in rec_db2.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val2_set = [store]\n","  bf2 = bf.set_to_bloom_filter(val2_set)\n","  temp2[v[0]] = bf2 # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf2)\n","  db2.append(2)"]},{"cell_type":"code","execution_count":262,"metadata":{"id":"b1KnUa8dw0by","executionInfo":{"status":"ok","timestamp":1667452439262,"user_tz":-660,"elapsed":4,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["temp3 = dict()\n","db3 = list()\n","for k, v in rec_db3.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val3_set = [store]\n","  bf3 = bf.set_to_bloom_filter(val3_set)\n","  temp3[v[0]] = bf3  # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf3)\n","  db3.append(3)"]},{"cell_type":"code","execution_count":263,"metadata":{"id":"0sEMd_HXCcS6","executionInfo":{"status":"ok","timestamp":1667452439630,"user_tz":-660,"elapsed":1,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["temp4 = dict()\n","db4 = list()\n","for k, v in rec_db4.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val4_set = [store]\n","  bf4 = bf.set_to_bloom_filter(val4_set)\n","  temp4[v[0]] = bf4  # append it into a dafarame instead of disctionary ??\n","  db4.append(4)"]},{"cell_type":"code","execution_count":264,"metadata":{"id":"AnWiH_mJCv_0","executionInfo":{"status":"ok","timestamp":1667452440075,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["temp5 = dict() \n","db5 = list()\n","for k, v in rec_db5.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val5_set = [store]\n","  bf5 = bf.set_to_bloom_filter(val5_set)\n","  temp5[v[0]] = bf5  # append it into a dafarame instead of disctionary ??\n","  db5.append(5)"]},{"cell_type":"markdown","source":["### Encoding datasets with 20 OCP"],"metadata":{"id":"AFgPSPOgComy"}},{"cell_type":"code","source":["listBF = list() # creating a list to store hashed arrays of first 3 table only\n","dictBF = dict()"],"metadata":{"id":"eTbRb3YKC2s4","executionInfo":{"status":"ok","timestamp":1667452295549,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"execution_count":237,"outputs":[]},{"cell_type":"code","execution_count":238,"metadata":{"id":"9T3TGTCtChmF","executionInfo":{"status":"ok","timestamp":1667452295549,"user_tz":-660,"elapsed":1,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["# for each record of selected csv file, use BF encoding, combine all the columns into a single array and hash it, and store \n","temp1 = dict()\n","db1 = list()\n","for k, v in rec_db1_20.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4] \n","  val2_set = [store]\n","  bf1 = bf.set_to_bloom_filter(val2_set)\n","  temp1[v[0]] = bf1 # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf1)\n","  db1.append(1)"]},{"cell_type":"code","execution_count":239,"metadata":{"id":"iEWLqseeChmF","executionInfo":{"status":"ok","timestamp":1667452295886,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["temp2 = dict()\n","db2 = list()\n","for k, v in rec_db2_20.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val2_set = [store]\n","  bf2 = bf.set_to_bloom_filter(val2_set)\n","  temp2[v[0]] = bf2 # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf2)\n","  db2.append(2)"]},{"cell_type":"code","execution_count":240,"metadata":{"id":"4E19FeI0ChmG","executionInfo":{"status":"ok","timestamp":1667452295886,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["temp3 = dict()\n","db3 = list()\n","for k, v in rec_db3_20.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val3_set = [store]\n","  bf3 = bf.set_to_bloom_filter(val3_set)\n","  temp3[v[0]] = bf3  # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf3)\n","  db3.append(3)"]},{"cell_type":"code","execution_count":241,"metadata":{"id":"1Z2KsT58ChmG","executionInfo":{"status":"ok","timestamp":1667452296517,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["\n","temp4 = dict()\n","db4 = list()\n","for k, v in rec_db4_20.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val4_set = [store]\n","  bf4 = bf.set_to_bloom_filter(val4_set)\n","  temp4[v[0]] = bf4  # append it into a dafarame instead of disctionary ??\n","  db4.append(4)"]},{"cell_type":"code","execution_count":242,"metadata":{"id":"w8OZJnyIChmG","executionInfo":{"status":"ok","timestamp":1667452296978,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["temp5 = dict() \n","db5 = list()\n","for k, v in rec_db5_20.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val5_set = [store]\n","  bf5 = bf.set_to_bloom_filter(val5_set)\n","  temp5[v[0]] = bf5  # append it into a dafarame instead of disctionary ??\n","  db5.append(5)"]},{"cell_type":"code","source":[],"metadata":{"id":"sUOd91sOoQ-k"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### Encoding datasets with 40 OCP"],"metadata":{"id":"KB3OYQ3huRsv"}},{"cell_type":"code","source":["listBF = list() # creating a list to store hashed arrays of first 3 table only\n","dictBF = dict()"],"metadata":{"executionInfo":{"status":"ok","timestamp":1667463807819,"user_tz":-660,"elapsed":892,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"id":"pORR9i_loREU"},"execution_count":6,"outputs":[]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"status":"ok","timestamp":1667463808273,"user_tz":-660,"elapsed":5,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"id":"mWQX4g8IoREU"},"outputs":[],"source":["# for each record of selected csv file, use BF encoding, combine all the columns into a single array and hash it, and store \n","temp1 = dict()\n","db1 = list()\n","for k, v in rec_db1_40.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4] \n","  val2_set = [store]\n","  bf1 = bf.set_to_bloom_filter(val2_set)\n","  temp1[v[0]] = bf1 # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf1)\n","  db1.append(1)"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"status":"ok","timestamp":1667463808274,"user_tz":-660,"elapsed":5,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"id":"Nnq04PJWoREU"},"outputs":[],"source":["temp2 = dict()\n","db2 = list()\n","for k, v in rec_db2_40.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val2_set = [store]\n","  bf2 = bf.set_to_bloom_filter(val2_set)\n","  temp2[v[0]] = bf2 # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf2)\n","  db2.append(2)"]},{"cell_type":"code","execution_count":9,"metadata":{"executionInfo":{"status":"ok","timestamp":1667463808274,"user_tz":-660,"elapsed":5,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"id":"zx-fPCfEoREU"},"outputs":[],"source":["temp3 = dict()\n","db3 = list()\n","for k, v in rec_db3_40.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val3_set = [store]\n","  bf3 = bf.set_to_bloom_filter(val3_set)\n","  temp3[v[0]] = bf3  # append it into a dafarame instead of disctionary ??\n","  listBF.append(bf3)\n","  db3.append(3)"]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"status":"ok","timestamp":1667463808275,"user_tz":-660,"elapsed":5,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"id":"ia3mE8YDoREU"},"outputs":[],"source":["\n","temp4 = dict()\n","db4 = list()\n","for k, v in rec_db4_40.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val4_set = [store]\n","  bf4 = bf.set_to_bloom_filter(val4_set)\n","  temp4[v[0]] = bf4  # append it into a dafarame instead of disctionary ??\n","  db4.append(4)"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"status":"ok","timestamp":1667463808747,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"id":"xkFP2RosoREU"},"outputs":[],"source":["temp5 = dict() \n","db5 = list()\n","for k, v in rec_db5_40.items():\n","  store = v[1]+ v[2]+ v[3]+ v[4]\n","  val5_set = [store]\n","  bf5 = bf.set_to_bloom_filter(val5_set)\n","  temp5[v[0]] = bf5  # append it into a dafarame instead of disctionary ??\n","  db5.append(5)"]},{"cell_type":"markdown","metadata":{"id":"XIi6WCnqh6Lg"},"source":["--------------------------------------------------------------------------------"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"qmwHisoopy0M","executionInfo":{"status":"ok","timestamp":1667463809926,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["header = ['rec_id', 'Blooom_filters']\n","df1 = pd.DataFrame(temp1.items(), columns= header)\n","df1[\"database_id\"] = db1 #adding the database id\n","df1 = df1[['rec_id', \"database_id\",'Blooom_filters']] # rearrange the dataframe based on colunms"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"nyGFF2wup-4r","executionInfo":{"status":"ok","timestamp":1667463810757,"user_tz":-660,"elapsed":3,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["df2 = pd.DataFrame(temp2.items(), columns= header)\n","df2[\"database_id\"] = db2 \n","df2 = df2[['rec_id', \"database_id\",'Blooom_filters']]"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"tGiDojzht9Dt","executionInfo":{"status":"ok","timestamp":1667463810757,"user_tz":-660,"elapsed":2,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["df3 = pd.DataFrame(temp3.items(), columns= header) \n","df3[\"database_id\"] = db3 \n","df3 = df3[['rec_id', \"database_id\",'Blooom_filters']]"]},{"cell_type":"code","execution_count":15,"metadata":{"id":"VDtSs40aDASg","executionInfo":{"status":"ok","timestamp":1667463810758,"user_tz":-660,"elapsed":3,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["df4 = pd.DataFrame(temp4.items(), columns= header) \n","df4[\"database_id\"] = db4 \n","df4 = df4[['rec_id', \"database_id\",'Blooom_filters']]"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"5WqJ_k_LDApM","executionInfo":{"status":"ok","timestamp":1667463811291,"user_tz":-660,"elapsed":9,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["df5 = pd.DataFrame(temp5.items(), columns= header) \n","df5[\"database_id\"] = db5\n","df5 = df5[['rec_id', \"database_id\",'Blooom_filters']]"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1667463811291,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"},"user_tz":-660},"id":"qWUg682gCwwJ","outputId":"3629d57e-15af-4df9-8788-c25d971c8be8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["     rec_id  database_id                                     Blooom_filters\n","0  06755315            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...\n","1  03370376            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...\n","2  00406646            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","3  04381862            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","4  02347140            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ..."],"text/html":["\n","  <div id=\"df-6eb7a365-85f5-41f2-bcce-49662e99d792\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rec_id</th>\n","      <th>database_id</th>\n","      <th>Blooom_filters</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>06755315</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>03370376</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>00406646</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>04381862</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>02347140</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6eb7a365-85f5-41f2-bcce-49662e99d792')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6eb7a365-85f5-41f2-bcce-49662e99d792 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6eb7a365-85f5-41f2-bcce-49662e99d792');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":17}],"source":["First3Table = pd.concat([df1, df2, df3])\n","First3Table.head()"]},{"cell_type":"code","source":["First3Table.tail()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"8LM83R-r-yD2","executionInfo":{"status":"ok","timestamp":1667463811292,"user_tz":-660,"elapsed":8,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"outputId":"134885b7-5ea2-4e13-c1b2-52b7767a01c6"},"execution_count":18,"outputs":[{"output_type":"execute_result","data":{"text/plain":["      rec_id  database_id                                     Blooom_filters\n","95  05125467            3  [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, ...\n","96  02425955            3  [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","97  03331940            3  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","98  02158195            3  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","99  08195071            3  [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ..."],"text/html":["\n","  <div id=\"df-535b1101-7b02-4099-a6f2-2720e12bd8e7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rec_id</th>\n","      <th>database_id</th>\n","      <th>Blooom_filters</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>95</th>\n","      <td>05125467</td>\n","      <td>3</td>\n","      <td>[0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>96</th>\n","      <td>02425955</td>\n","      <td>3</td>\n","      <td>[0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>97</th>\n","      <td>03331940</td>\n","      <td>3</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>98</th>\n","      <td>02158195</td>\n","      <td>3</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>99</th>\n","      <td>08195071</td>\n","      <td>3</td>\n","      <td>[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-535b1101-7b02-4099-a6f2-2720e12bd8e7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-535b1101-7b02-4099-a6f2-2720e12bd8e7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-535b1101-7b02-4099-a6f2-2720e12bd8e7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":18}]},{"cell_type":"markdown","metadata":{"id":"sMB2YyYQz4N5"},"source":["# Clustering - 40 OCP errors in the datasets"]},{"cell_type":"code","source":["len(First3Table) #checking length of the first 3 tables"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"WQM-JgOV-0UI","executionInfo":{"status":"ok","timestamp":1667463812253,"user_tz":-660,"elapsed":7,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"outputId":"c5c4a290-6a32-463d-e11d-5384ac8b7340"},"execution_count":19,"outputs":[{"output_type":"execute_result","data":{"text/plain":["300"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":["start_time = time.time()\n","counter = -1     ## fix it \n","counter_clus = 0\n","num_clusters = 2\n","for i in range(len(First3Table)):\n","  Maincluster = AgglomerativeClustering(n_clusters = num_clusters).fit(listBF) # 50 is optimal number of clusters \n","  evaluation = silhouette_score(listBF, Maincluster.labels_)\n","  if evaluation > counter:\n","    counter = evaluation\n","    counter_clus = num_clusters\n","  num_clusters += 1\n","  if num_clusters == len(First3Table)-1:\n","    break\n","print('coefficient =', counter , \", \",  'the optimal number of cluster = ', counter_clus) # optimal number of cluster and percentage\n","print(\"--- time taken = %s seconds ---\" % (time.time() - start_time))"],"metadata":{"id":"q3w0Fz4AKFTE","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1667463818880,"user_tz":-660,"elapsed":6189,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"outputId":"e75849c8-f42f-4456-d8ca-8cb6855c4998"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stdout","text":["coefficient = 0.5877430228813401 ,  the optimal number of cluster =  59\n","--- time taken = 6.122396945953369 seconds ---\n"]}]},{"cell_type":"code","execution_count":253,"metadata":{"id":"CpFPMpKoDunI","executionInfo":{"status":"ok","timestamp":1667452386609,"user_tz":-660,"elapsed":290,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}}},"outputs":[],"source":["DMaincluster = AgglomerativeClustering(n_clusters = 155).fit(listBF)"]},{"cell_type":"code","source":["silhouette_score(listBF, Maincluster.labels_)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xHZCIBMcw2sr","executionInfo":{"status":"ok","timestamp":1667449775407,"user_tz":-660,"elapsed":20,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"}},"outputId":"0b42bdf1-7272-4036-9216-febf7156f2d7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.3862641337102947"]},"metadata":{},"execution_count":93}]},{"cell_type":"code","source":["len(Maincluster.labels_)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GwwUYwGP_cnO","executionInfo":{"status":"ok","timestamp":1667449775889,"user_tz":-660,"elapsed":4,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"}},"outputId":"a5fc9db7-2f85-4c7a-dbbe-4c0a66812efb"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["300"]},"metadata":{},"execution_count":94}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RywdF7B7g2J-"},"outputs":[],"source":["Maincluster.labels_[:300].sort() # sorting clusterd id in ascending order  so that we can see how many of each BF belongs to which cluster_id "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":302,"status":"ok","timestamp":1667449504877,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"},"user_tz":-660},"id":"HR2qKHIOsaoX","outputId":"6674b684-6985-450c-c304-6125b7a687b1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   cluster_id                                                 BF\n","0           0  [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","1           0  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...\n","2           0  [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...\n","3           0  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, ...\n","4           0  [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ..."],"text/html":["\n","  <div id=\"df-c9cbe27f-84a0-46e2-a7a5-01d8e6321c97\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>cluster_id</th>\n","      <th>BF</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>[0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c9cbe27f-84a0-46e2-a7a5-01d8e6321c97')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c9cbe27f-84a0-46e2-a7a5-01d8e6321c97 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c9cbe27f-84a0-46e2-a7a5-01d8e6321c97');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":60}],"source":["cluster_map = pd.DataFrame() ## n_clusters = 1274 , n_clusters = 155 for testing purposes\n","cluster_map['cluster_id'] = Maincluster.labels_\n","cluster_map['BF'] = listBF\n","cluster_map.head() # bloomFilter and it cluster\n"]},{"cell_type":"code","source":["cluster_map.tail() # bloomFilter and it cluster"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"hTSfpFf2GGM_","executionInfo":{"status":"ok","timestamp":1667449506533,"user_tz":-660,"elapsed":308,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"}},"outputId":"56bd43de-1301-4eac-9de4-a9d6824deea6"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["     cluster_id                                                 BF\n","295         152  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","296         152  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","297         153  [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, ...\n","298         154  [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...\n","299         154  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ..."],"text/html":["\n","  <div id=\"df-9e21efcd-14b4-43a6-90fd-35c6480c3384\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>cluster_id</th>\n","      <th>BF</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>295</th>\n","      <td>152</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>296</th>\n","      <td>152</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>297</th>\n","      <td>153</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>298</th>\n","      <td>154</td>\n","      <td>[0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>299</th>\n","      <td>154</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9e21efcd-14b4-43a6-90fd-35c6480c3384')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9e21efcd-14b4-43a6-90fd-35c6480c3384 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9e21efcd-14b4-43a6-90fd-35c6480c3384');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":61}]},{"cell_type":"code","source":["import scipy.cluster.hierarchy as shc\n","start_time = time.time()\n","\n","\n","plt.figure(figsize=(10, 7))  \n","plt.title(\"Dendrograms\")  \n","dend = shc.dendrogram(shc.linkage(listBF, method='ward'))\n","\n","print(\"--- time taken for Dendrograms = %s seconds ---\" % (time.time() - start_time))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":462},"id":"oW1ke9kNwAx2","executionInfo":{"status":"ok","timestamp":1667449517657,"user_tz":-660,"elapsed":10121,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"}},"outputId":"fe9efa79-57f6-4fc6-bf64-41d33626f24e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["--- time taken for Dendrograms = 0.4544408321380615 seconds ---\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 720x504 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","metadata":{"id":"xyBAFE28f1nb"},"source":["# Use SQL database to store the dataframe generated by the first 3 csv records  "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gn2dqCeNxv86"},"outputs":[],"source":["` #rslt_df #checking cluster "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1DOcG_28hutV"},"outputs":[],"source":["# import packages for a SQL server\n","#import numpy as np  \n","#import sqlite3 #\n","#from sqlalchemy import create_engine "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EMGh16wHVIyI"},"outputs":[],"source":["# Using SQL = Pandas uses memory and will hold dataframes in RAM.\n","# The maximum storage will be equal to RAM.\n","# SQL on the other hand uses storage to store data.\n","# Use \n","\n","#1. save the clustered data to a SQL database\n","#2. save more incoming data to clustered database\n","#3. make a class solution where you can dynamically store and process these values"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"scY0erEzfzis"},"outputs":[],"source":["# cav_database = create-engine\n","# create a connector to a database \n"]},{"cell_type":"markdown","metadata":{"id":"YfKW8hR0zSGZ"},"source":["# Data Linkage"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ndlYuXjpzXUO"},"outputs":[],"source":["# finding an efficient way to link the new record (from 4 and 5 ) to the existing cluster"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"L6aeRfjQk0LQ"},"outputs":[],"source":["#first method\n","#The code below aims to get the average of all binary record for each cluster id.(using binary addition and division) \n","\n","max = cluster_map.iloc[len(cluster_map)-1, 0]\n","listexp = list()\n","loop = 0\n","averages = dict()\n","for i in range(max): \n","  for j in range(len(cluster_map)): #loop through the cluster_map table\n","      if cluster_map.iloc[j, 0] == loop: #identify a single cluster id and store it binary record in a temporary list\n","        listexp.append(cluster_map.iloc[j, 1])\n","  sum = \"0\"\n","  div = 0\n","  for k in range(len(listexp)): #loop through the list created\n","    flow = listexp[k].to01()\n","    sum = bin(int(sum, 2) + int(flow, 2)) # add all binary record in that list \n","    div += 1\n","    num = int(sum, 2) # devide the sum to get the average for each cluster id\n","  ans = bin(int(num/div))\n","  averages[loop] = ans[2:]\n","  loop += 1"]},{"cell_type":"markdown","metadata":{"id":"WXqOrsU67sjC"},"source":["# Dynamic Update - 4th and 5th datasets into the clusters\n"]},{"cell_type":"code","execution_count":224,"metadata":{"id":"9X8kXlzjeuwk","executionInfo":{"status":"error","timestamp":1667451906403,"user_tz":-660,"elapsed":3,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"colab":{"base_uri":"https://localhost:8080/","height":235},"outputId":"402c8763-ced3-430e-e195-830870485a81"},"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-224-1da2bd058c1a>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      8\u001b[0m   \u001b[0mbf4\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mbf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mset_to_bloom_filter\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mval4_set\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;31m# attain bloom filter for each record\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      9\u001b[0m   \u001b[0;31m#the next stage is used to balance the length of each bloom filter from the averages list.(when getting the average the length of the bloom filter changes)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 10\u001b[0;31m   \u001b[0;32mfor\u001b[0m \u001b[0mk1\u001b[0m \u001b[0;32min\u001b[0m \u001b[0maverages\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkeys\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     11\u001b[0m     \u001b[0mstore\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mbitarray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0maverages\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mk1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     12\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0maverages\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mk1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbf4\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m>\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'averages' is not defined"]}],"source":["# the code below aim to find the best cluster id for incoming record from 4th csv file.  //////// Mean vector should have the same length //////// list of values, \n","\n","keep = 0\n","score = 0\n","for k, v in rec_db4.items(): # loop through the row of 4th csv file for each record\n","  store = v[0]+ v[1]+ v[2]+ v[3]\n","  val4_set = [store]\n","  bf4 = bf.set_to_bloom_filter(val4_set)# attain bloom filter for each record\n","  #the next stage is used to balance the length of each bloom filter from the averages list.(when getting the average the length of the bloom filter changes)\n","  for k1 in averages.keys():\n","    store = bitarray(averages[k1])\n","    if len(averages[k1]) - len(bf4) > 0:\n","      for j in range(len(averages[k1]) - len(bf4)):\n","        bf4[:0] = bitarray(\"0\")\n","    else:\n","      if len(bf4) - len(averages[k1]) > 0:\n","        for i in range(len(bf4) - len(averages[k1])):\n","          store[:0] = bitarray(\"0\")\n","# for each record from 4th csv file, compare the similarity with each cluster average to the get the optimal cluster it belongs to.       \n","    if bf.calc_bf_sim(bf4,store) >= score:\n","      keep = k1\n","      store = bitarray(averages[k1])\n","  cluster_map.loc[len(cluster_map)+1] = [keep, bf4] #add the new record to the cluster map table "]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KwzkbJPkD4hR"},"outputs":[],"source":["# the code is as similar to the one above, but for the 5th table\n","keep = 0\n","score = 0\n","for k, v in rec_db5.items():\n","  store = v[0]+ v[1]+ v[2]+ v[3]\n","  val5_set = [store]\n","  bf5 = bf.set_to_bloom_filter(val5_set)\n","  for k1 in averages.keys():\n","    store = bitarray(averages[k1])\n","    if len(averages[k1]) - len(bf5) > 0:\n","      for j in range(len(averages[k1]) - len(bf5)):\n","        bf5[:0] = bitarray(\"0\")\n","    else:\n","      if len(bf5) - len(averages[k1]) > 0:\n","        for i in range(len(bf5) - len(averages[k1])):\n","          store[:0] = bitarray(\"0\")\n","    if bf.calc_bf_sim(bf5,store) >= score:\n","      keep = k1\n","      store = bitarray(averages[k1])\n","  cluster_map.loc[len(cluster_map)+1] = [keep, bf5]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22,"status":"ok","timestamp":1667449524364,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"},"user_tz":-660},"id":"HIKxmiQ8f-JC","outputId":"c0f5871a-0438-490e-9d99-abbf08f3c71d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["500"]},"metadata":{},"execution_count":66}],"source":["len(cluster_map)"]},{"cell_type":"markdown","metadata":{"id":"rm-B5auz-Ik2"},"source":["# The next and final step \n","##### Connect the cluster map table to the other table with the record id. To produce the final cvs file (result)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":25,"status":"ok","timestamp":1667449524368,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"},"user_tz":-660},"id":"Nc6-OPSqCRuo","outputId":"5364ff1e-79a3-42b1-e1cb-9dd5dfda96ab"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["500"]},"metadata":{},"execution_count":67}],"source":["df_all_rows = pd.concat([df1, df2, df3, df4, df5]) # \n","len(df_all_rows)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HP2aTht2EoXW"},"outputs":[],"source":["cluster_col = cluster_map.cluster_id.values.tolist()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":363},"executionInfo":{"elapsed":30,"status":"ok","timestamp":1667449524376,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"},"user_tz":-660},"id":"UgbqFJWWDmrx","outputId":"5e47ab6f-96ed-4ba2-981f-4e2ca904171b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["    rec_id  database_id                                     Blooom_filters  \\\n","0  7546882            1  [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","1  3274759            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...   \n","2  4597785            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...   \n","3  4616218            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, ...   \n","4  2832413            1  [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","5  8183846            1  [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","6  6608939            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, ...   \n","7  2222125            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","8  5789746            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","9  1148995            1  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","\n","   cluster_id  \n","0           0  \n","1           0  \n","2           0  \n","3           0  \n","4           0  \n","5           0  \n","6           1  \n","7           1  \n","8           1  \n","9           1  "],"text/html":["\n","  <div id=\"df-6ef3fd8a-b65d-41e4-9760-f99054c17cdb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rec_id</th>\n","      <th>database_id</th>\n","      <th>Blooom_filters</th>\n","      <th>cluster_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>7546882</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>3274759</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>4597785</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>4616218</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2832413</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>8183846</td>\n","      <td>1</td>\n","      <td>[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>6608939</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, ...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>2222125</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>5789746</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>1148995</td>\n","      <td>1</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6ef3fd8a-b65d-41e4-9760-f99054c17cdb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6ef3fd8a-b65d-41e4-9760-f99054c17cdb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6ef3fd8a-b65d-41e4-9760-f99054c17cdb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":69}],"source":["df_all_rows[\"cluster_id\"] = cluster_col #//////grand total should have same clusterid with different database_id /// each cluster should have same rec_id, the cluster we have now is not pure \n","df_all_rows.head(10)\n"]},{"cell_type":"code","source":["df_all_rows.tail()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"aJjURgSlpONY","executionInfo":{"status":"ok","timestamp":1667449524377,"user_tz":-660,"elapsed":30,"user":{"displayName":"Jinjia Bai","userId":"04487049179225043528"}},"outputId":"7247805d-6ca0-47cd-da04-6878bf1d5b77"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["     rec_id  database_id                                     Blooom_filters  \\\n","95  4590505            5  [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","96  2548666            5  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, ...   \n","97  6949828            5  [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, ...   \n","98   199634            5  [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, ...   \n","99  5483476            5  [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, ...   \n","\n","    cluster_id  \n","95         153  \n","96         153  \n","97         153  \n","98         153  \n","99         153  "],"text/html":["\n","  <div id=\"df-d1bd5116-9b1f-4df5-a636-f49e3f8ec851\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rec_id</th>\n","      <th>database_id</th>\n","      <th>Blooom_filters</th>\n","      <th>cluster_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>95</th>\n","      <td>4590505</td>\n","      <td>5</td>\n","      <td>[0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>153</td>\n","    </tr>\n","    <tr>\n","      <th>96</th>\n","      <td>2548666</td>\n","      <td>5</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, ...</td>\n","      <td>153</td>\n","    </tr>\n","    <tr>\n","      <th>97</th>\n","      <td>6949828</td>\n","      <td>5</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>153</td>\n","    </tr>\n","    <tr>\n","      <th>98</th>\n","      <td>199634</td>\n","      <td>5</td>\n","      <td>[0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, ...</td>\n","      <td>153</td>\n","    </tr>\n","    <tr>\n","      <th>99</th>\n","      <td>5483476</td>\n","      <td>5</td>\n","      <td>[0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, ...</td>\n","      <td>153</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d1bd5116-9b1f-4df5-a636-f49e3f8ec851')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d1bd5116-9b1f-4df5-a636-f49e3f8ec851 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d1bd5116-9b1f-4df5-a636-f49e3f8ec851');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":70}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0u1S8OWHDeZD"},"outputs":[],"source":["df_all_rows.to_csv('Final_result.csv', index=False)"]},{"cell_type":"markdown","metadata":{"id":"zDx815iKvIbu"},"source":["# Testing"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"E8OYiT6sFT-u"},"outputs":[],"source":["og_tab1 = pd.read_csv('ncvr_numrec_100_modrec_2_ocp_0_myp_0_nump_5.csv')\n","og_tab2 = pd.read_csv('ncvr_numrec_100_modrec_2_ocp_0_myp_1_nump_5.csv')\n","og_tab3 = pd.read_csv('ncvr_numrec_100_modrec_2_ocp_0_myp_2_nump_5.csv')\n","og_tab4 = pd.read_csv('ncvr_numrec_100_modrec_2_ocp_0_myp_3_nump_5.csv')\n","og_tab5 = pd.read_csv('ncvr_numrec_100_modrec_2_ocp_0_myp_4_nump_5.csv')"]},{"cell_type":"code","source":["def remove_name(og_tab0): # a function remove_name() will rename the wrong columns allocation to the proper names and drop unnecessary columns\n","  og_tab0.rename(columns = {'voter_reg_num':'First Name', \n","                          'name_prefix':'Last Name', \n","                          'first_name': 'City', \n","                          'middle_name': 'Post Code'}, inplace = True) ## Fixing name errors of original datasets \n","\n","  og_tab0.drop(og_tab0.columns[[range(5, 19)]], axis=1, inplace=True) ## dropping unnecessary columns from index: 5 to 19 "],"metadata":{"id":"GeE9JehO9cAE"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["remove_name(og_tab0)\n","remove_name(og_tab1)\n","remove_name(og_tab2)\n","remove_name(og_tab3)\n","remove_name(og_tab4)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":453},"id":"sNo0oa1TH1aR","executionInfo":{"status":"error","timestamp":1667137004424,"user_tz":-660,"elapsed":5,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"outputId":"6592b867-f514-4844-ef94-191cbab43dbb"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/pandas/core/indexes/base.py:4616: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.\n","  result = getitem(key)\n"]},{"output_type":"error","ename":"IndexError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mIndexError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-53-74ad688bf487>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mremove_name\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mog_tab0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mremove_name\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mog_tab1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mremove_name\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mog_tab2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0mremove_name\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mog_tab3\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mremove_name\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mog_tab4\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<ipython-input-52-4c27a558f22e>\u001b[0m in \u001b[0;36mremove_name\u001b[0;34m(og_tab0)\u001b[0m\n\u001b[1;32m      5\u001b[0m                           'middle_name': 'Post Code'}, inplace = True) ## Fixing name errors of original datasets \n\u001b[1;32m      6\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 7\u001b[0;31m   \u001b[0mog_tab0\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdrop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mog_tab0\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mrange\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m5\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m19\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minplace\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;31m## dropping unnecessary columns from index: 5 to 19\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/pandas/core/indexes/base.py\u001b[0m in \u001b[0;36m__getitem__\u001b[0;34m(self, key)\u001b[0m\n\u001b[1;32m   4614\u001b[0m             \u001b[0mkey\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0masarray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdtype\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mbool\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   4615\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 4616\u001b[0;31m         \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mgetitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkey\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   4617\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mis_scalar\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresult\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   4618\u001b[0m             \u001b[0;31m# error: Argument 1 to \"ndim\" has incompatible type \"Union[ExtensionArray,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mIndexError\u001b[0m: index 5 is out of bounds for axis 0 with size 5"]}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1667137004984,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"},"user_tz":-660},"id":"JUJYhz37JwIT","outputId":"91a294ab-a934-4233-f021-5d904cf8ba68"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["    rec_id First Name        Last Name          City  Post Code\n","0  6978370  graziella  gambale-marengi       raleigh      27617\n","1  2347140        kia        mccormick       raleigh      27603\n","2  3370376  elizabeth         phillips  robbinsville      28771\n","3  7621378    sherlyn           penado      gastonia      28056\n","4   216852     vernon            smith        durham      27704"],"text/html":["\n","  <div id=\"df-4939a179-5788-4417-8604-64fbd610c02e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rec_id</th>\n","      <th>First Name</th>\n","      <th>Last Name</th>\n","      <th>City</th>\n","      <th>Post Code</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>6978370</td>\n","      <td>graziella</td>\n","      <td>gambale-marengi</td>\n","      <td>raleigh</td>\n","      <td>27617</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2347140</td>\n","      <td>kia</td>\n","      <td>mccormick</td>\n","      <td>raleigh</td>\n","      <td>27603</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>3370376</td>\n","      <td>elizabeth</td>\n","      <td>phillips</td>\n","      <td>robbinsville</td>\n","      <td>28771</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>7621378</td>\n","      <td>sherlyn</td>\n","      <td>penado</td>\n","      <td>gastonia</td>\n","      <td>28056</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>216852</td>\n","      <td>vernon</td>\n","      <td>smith</td>\n","      <td>durham</td>\n","      <td>27704</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4939a179-5788-4417-8604-64fbd610c02e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4939a179-5788-4417-8604-64fbd610c02e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4939a179-5788-4417-8604-64fbd610c02e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":54}],"source":["og_tab0.head()"]},{"cell_type":"code","source":["  og_tab2.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":270},"id":"Yx6pWW6nAYeL","executionInfo":{"status":"ok","timestamp":1667137005447,"user_tz":-660,"elapsed":4,"user":{"displayName":"Kairi Kurachi","userId":"01373093198210756571"}},"outputId":"ca5f24d9-eda3-4424-e05e-6a55d0e465e4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["    rec_id voter_reg_num name_prefix   first_name  middle_name  last_name  \\\n","0  4489635         diana   libberton       hubert        28539        NaN   \n","1  3597241        lillie    sullivan      raleigh        27606        NaN   \n","2  7621378       sherlyn      penado     gastonia        28056        NaN   \n","3  5029442       theresa       moore  chocowinity        27817        NaN   \n","4  6845956   christopher   trombello    charlotte        28227        NaN   \n","\n","   name_suffix  age  gender  race  ethnic  street_address  city  state  \\\n","0          NaN  NaN     NaN   NaN     NaN             NaN   NaN    NaN   \n","1          NaN  NaN     NaN   NaN     NaN             NaN   NaN    NaN   \n","2          NaN  NaN     NaN   NaN     NaN             NaN   NaN    NaN   \n","3          NaN  NaN     NaN   NaN     NaN             NaN   NaN    NaN   \n","4          NaN  NaN     NaN   NaN     NaN             NaN   NaN    NaN   \n","\n","   zip_code  full_phone_num  birth_place  register_date  download_month  \n","0       NaN             NaN          NaN            NaN             NaN  \n","1       NaN             NaN          NaN            NaN             NaN  \n","2       NaN             NaN          NaN            NaN             NaN  \n","3       NaN             NaN          NaN            NaN             NaN  \n","4       NaN             NaN          NaN            NaN             NaN  "],"text/html":["\n","  <div id=\"df-e7fd7ab8-1993-407c-8d07-c8dc9bca91cd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rec_id</th>\n","      <th>voter_reg_num</th>\n","      <th>name_prefix</th>\n","      <th>first_name</th>\n","      <th>middle_name</th>\n","      <th>last_name</th>\n","      <th>name_suffix</th>\n","      <th>age</th>\n","      <th>gender</th>\n","      <th>race</th>\n","      <th>ethnic</th>\n","      <th>street_address</th>\n","      <th>city</th>\n","      <th>state</th>\n","      <th>zip_code</th>\n","      <th>full_phone_num</th>\n","      <th>birth_place</th>\n","      <th>register_date</th>\n","      <th>download_month</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>4489635</td>\n","      <td>diana</td>\n","      <td>libberton</td>\n","      <td>hubert</td>\n","      <td>28539</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>3597241</td>\n","      <td>lillie</td>\n","      <td>sullivan</td>\n","      <td>raleigh</td>\n","      <td>27606</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>7621378</td>\n","      <td>sherlyn</td>\n","      <td>penado</td>\n","      <td>gastonia</td>\n","      <td>28056</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>5029442</td>\n","      <td>theresa</td>\n","      <td>moore</td>\n","      <td>chocowinity</td>\n","      <td>27817</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>6845956</td>\n","      <td>christopher</td>\n","      <td>trombello</td>\n","      <td>charlotte</td>\n","      <td>28227</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e7fd7ab8-1993-407c-8d07-c8dc9bca91cd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e7fd7ab8-1993-407c-8d07-c8dc9bca91cd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e7fd7ab8-1993-407c-8d07-c8dc9bca91cd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":55}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3LOG8GkdvHU4"},"outputs":[],"source":["original_df = pd.concat([og_tab1, og_tab2, og_tab3, og_tab4])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eV60nLSXGhJ4"},"outputs":[],"source":["loop = 94\n","keep1 = list()\n","result = list()\n","for i in range(len(df_all_rows)):\n","  if df_all_rows.iloc[i, 3] == loop:\n","    keep1.append(int(df_all_rows.iloc[i, 0]))\n","for j in range(len(original_df)):\n","  if original_df.iloc[j, 0] in keep1:\n","    result.append(original_df.iloc[j, 0])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1667113181771,"user":{"displayName":"Johnson S. Grear Jr","userId":"08797184162084616032"},"user_tz":-660},"id":"Nfss0xaYJyNg","outputId":"4377244e-0d37-44ea-aacf-dc9e6b3dddfa"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["3"]},"metadata":{},"execution_count":152}],"source":["len(result)"]},{"cell_type":"code","source":["result"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Gy8nft9_ozfy","executionInfo":{"status":"ok","timestamp":1667113184012,"user_tz":-660,"elapsed":5,"user":{"displayName":"Johnson S. Grear Jr","userId":"08797184162084616032"}},"outputId":"2873f5e6-30cc-4a42-8e1e-bd97514dee62"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[7696253, 7696253, 7696253]"]},"metadata":{},"execution_count":153}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":378,"status":"ok","timestamp":1667113103395,"user":{"displayName":"Johnson S. Grear Jr","userId":"08797184162084616032"},"user_tz":-660},"id":"_yh7g50NGpHo","outputId":"41dffeed-a87e-4069-a6a1-6b7e87196510"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["1"]},"metadata":{},"execution_count":139}],"source":["#unique value of each cluster created\n","result = set(result)\n","len(result)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XsNaBoeR-XKv"},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"IUXy9Y2FmOQ2"},"source":["# Dont run"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IXoqMeBBoRLp"},"outputs":[],"source":["# test don't run\n","#wrongcount = 0\n","#keep1 = list()\n","#result = list()\n","#for i in range(counter_clus):\n","  #for k in range(len(df_all_rows)):\n","    #if df_all_rows.iloc[k, 3] == i:\n","      #keep1.append(int(df_all_rows.iloc[k, 0][1:]))\n","    #for j in range(len(original_df)):\n","      #if original_df.iloc[j, 0] in keep1:\n","        #result.append(original_df.iloc[j, 0])\n","    #myset = set(result)\n","    #if len(myset) > 1:\n","      #wrongcount += 1"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AhlXLge1mMrD"},"outputs":[],"source":["#first method\n","#The code below aims to get the average of all binary record for each cluster id.(using binary addition and division) \n","max = cluster_map.iloc[len(cluster_map)-1, 0]\n","listexp = list()\n","loop = 0\n","averages = dict()\n","for i in range(max): \n","  for j in range(len(cluster_map)): #loop through the cluster_map table\n","      if cluster_map.iloc[j, 0] == loop: #identify a single cluster id and store it binary record in a temporary list\n","        listexp.append(cluster_map.iloc[j, 1])\n","  sum = \"0\"\n","  div = 0\n","  for k in range(len(listexp)): #loop through the list created\n","    flow = listexp[k].to01()\n","    sum = bin(int(sum, 2) + int(flow, 2)) # add all binary record in that list \n","    div += 1\n","    num = int(sum, 2) # devide the sum to get the average for each cluster id\n","  ans = bin(int(num/div))\n","  averages[loop] = ans[2:]\n","  loop += 1\n","\n","#second method \n","#second method - go find each cluster and find the average of the cluster \n","listexp = list()\n","averages = dict()\n","for i in range(counter_clus): \n","  for j in range(len(cluster_map)):       #loop through the cluster_map table\n","    if cluster_map.iloc[j, 0] == i:              #identify a single cluster id and store it binary record in a temporary list\n","      listexp.append(cluster_map.iloc[j, 1])\n","  res = list()\n","  for y in range(len(listexp[0])):\n","    tempList = list()\n","    for k in range(len(listexp)):\n","      flow = listexp[k].to01()\n","      tempList.append(int(flow[y]))\n","    res.append(round(mean(tempList), 6))\n","  averages[i] = res\n","\n","\n","keep = 0\n","score = 0\n","for k, v in rec_db4.items():\n","  store = v[0]+ v[1]+ v[2]+ v[3]\n","  val4_set = [store]\n","  bf4 = bf.set_to_bloom_filter(val4_set)\n","  \n","  for k1 in averages.keys():\n","    s = ''.join(str(x) for x in averages[k1])\n","    if bf.calc_str_sim(bf4.to01(), s) >= score:\n","      keep = k1\n","  cluster_map.loc[len(cluster_map)+1] = [keep, bf4] \n"]}],"metadata":{"colab":{"collapsed_sections":[],"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}